# 游戏交互设计文档

**最后更新**: 2025-12-07
**负责人**: 主架构师 (Manus)

---

## 1. 概述 (Overview)

本文档详细定义了《锈湖：炼金术士的天体仪》中的所有玩家交互功能。它将作为技术规划Manus对话设计C++模块和蓝图接口的依据，并指导美术和动画Manus对话制作相应的视觉和动态效果。

## 2. 核心交互哲学

- **直观性**: 交互方式应符合点击式解谜游戏的惯例，易于理解。
- **沉浸感**: 交互应伴随有意义的视觉和听觉反馈，增强玩家的沉浸感。
- **叙事性**: 每一次交互都应服务于游戏叙事，推动故事发展或揭示世界观。

## 3. 通用交互类型

这些是贯穿整个游戏的基础交互功能，将由`InteractionSystem`模块提供核心支持。

| 交互类型 | 玩家操作 | 系统响应 | 技术实现要点 |
| :--- | :--- | :--- | :--- |
| **观察 (Observe)** | 鼠标/触摸点击一个非关键的背景对象。 | 显示一段描述性文本或主角的内心独白。 | 调用`DialogueSystem`显示文本。对象实现`IInteractable`接口的`OnInteract`事件。 |
| **聚焦/高亮 (Focus)** | 鼠标悬停/手指靠近一个可交互对象。 | 对象边缘出现高亮轮廓，或鼠标指针变为特殊图标（如手、眼睛）。 | `InteractionComponent`调用`IInteractable`的`OnBeginFocus`/`OnEndFocus`事件，触发后期处理材质（Post-Process Material）或UI变化。 |
| **拾取 (Pickup)** | 点击一个可收集的物品。 | 物品从场景中消失，并出现在玩家的背包UI中。播放拾取音效。 | 调用`InventorySystem`的`AddItem`函数。销毁场景中的Actor。 |
| **场景切换 (Navigate)** | 点击场景中的特定区域（如门、画）。 | 摄像机平滑过渡到新的场景或视角。加载/卸载相应的子关卡。 | 调用`CoreGame`模块的关卡加载功能，使用`Level Streaming`。 |
| **特写观察 (Examine)** | 在背包中点击一个物品的“观察”按钮。 | 进入一个特写观察模式，玩家可以360度旋转和缩放该物品。 | 创建一个独立的观察场景，将物品Actor生成其中，并切换玩家的输入模式以控制观察相机。 |

## 4. 特定谜题交互

这些是为游戏中各个核心谜题定制的特殊交互功能。每个交互都需要一个或多个C++基类和蓝图子类来实现。

### 第一章：乌鸦与钟楼

| 谜题 | 交互功能 | 描述 | 技术实现建议 |
| :--- | :--- | :--- | :--- |
| **齿轮谜题** | 拖放 (Drag and Drop) | 玩家从一个齿轮堆中拖动不同大小的齿轮，并将其放置到墙上正确的轴上。 | 创建一个`APuzzle_DragAndDrop`基类。使用UMG或3D Widget作为拖放的UI表示。 |
| **钟表谜题** | 旋转 (Rotate) | 玩家可以点击并拖动时钟的指针，将其调整到特定的时间。 | 创建一个`APuzzle_Rotatable`基类，根据鼠标/触摸的移动计算旋转角度。 |
| **音乐盒谜题** | 序列输入 (Sequence Input) | 玩家需要按照正确的顺序点击音乐盒上的音符按钮，以播放正确的旋律。 | 创建一个`APuzzle_SequenceInput`基类，内部维护一个正确的序列数组和一个玩家输入的序列数组进行比对。 |
| **幻灯机谜题** | 滑块调整 (Slider) & 物品使用 | 玩家需要将“幻灯片”物品从背包拖到幻灯机上，然后通过一个UI滑块来调整焦距。 | 结合物品使用交互和UMG滑块控件。滑块的值与后期处理效果或材质参数绑定。 |

### 第二章：蝴蝶与画廊

| 谜题 | 交互功能 | 描述 | 技术实现建议 |
| :--- | :--- | :--- | :--- |
| **蝴蝶捕捉** | 点击捕捉 (Timing Click) | 玩家需要在飞舞的蝴蝶移动到特定区域时进行点击，以成功捕捉。 | 蝴蝶Actor在场景中按预设路径移动，玩家点击时进行碰撞或范围检测。 |
| **调色盘谜题** | 混合 (Combine) | 玩家将不同颜色的“蝴蝶”物品拖入调色盘的槽位中，以混合出新的颜色。 | 类似于拖放谜题，但增加了颜色混合的逻辑，可以通过材质参数或代码进行颜色计算。 |
| **画作排序** | 序列点击 (Sequence Click) | 玩家需要按照特定顺序点击墙上的一系列画作。 | 类似于序列输入谜题，但交互对象是世界中的多个Actor。 |

### 第三章：双子与舞台

| 谜题 | 交互功能 | 描述 | 技术实现建议 |
| :--- | :--- | :--- | :--- |
| **天平谜题** | 放置物品 (Place Item) | 玩家需要将背包中的“心脏”和“羽毛”物品放置到天平的两端，以使其平衡。 | 定义天平托盘为可交互的“容器”对象，接受特定类型的物品。 |
| **木偶操控** | 合作交互 (Co-op Control) | 玩家需要切换控制两个木偶，一个按住开关，另一个通过打开的门。 | 创建一个角色切换机制。一个木偶的交互可以改变另一个木偶可交互对象的状态。 |

## 5. 背包交互 (Inventory Interactions)

背包系统不仅用于存储物品，还支持物品之间的交互。

| 交互类型 | 玩家操作 | 系统响应 | 技术实现要点 |
| :--- | :--- | :--- | :--- |
| **物品使用** | 从背包中拖动物品到场景中的一个可交互对象上。 | 如果物品和对象匹配，则触发特定事件（如用钥匙开锁）。 | `InteractionComponent`需要检测拖放操作。在`IInteractable`接口中添加`OnUseItem`函数。 |
| **物品组合** | 在背包UI中，将一个物品拖动到另一个物品上。 | 如果两个物品可以组合，它们会从背包中消失，并生成一个新的组合物品。 | 在`UInventoryComponent`中实现组合逻辑。组合规则可以通过一个数据表（`DT_Combinations`）来定义。 |

## 6. 总结

本交互设计文档为游戏的C++模块开发和蓝图实现提供了明确的需求。技术规划Manus对话应确保所有C++基类都包含处理这些交互所需的接口和事件。美术和动画Manus对话则需要为这些交互提供相应的视觉反馈，如高亮效果、拖放图标、物品模型和动画等。
